"use strict";function eosUploaderFile(i){var e={},o=i.upType;e[i.uploaderObj]=WebUploader.create({auto:!1,swf:"../assets/plugins/webuploader/js/Uploader.swf",server:i.serverUrl,formData:i.data,pick:i.initBtn,fileNumLimit:i.fileNumLimit,resize:!1,fileSingleSizeLimit:16777216,accept:{title:"intoTypes",extensions:"rar,zip,doc,xls,docx,xlsx,pdf",mimeTypes:""}}),e[i.uploaderObj].on("fileQueued",function(e){$(i.uploaderBox).find(i.uploaderList).append('<div id="'+e.id+'" class="item" data=""><h4 class="info">'+e.name+'</h4><div class="progress progress-striped active"><div class="progress-bar" role="progressbar" style="width: 0%"></div></div><div class="action"><button class="startBtn btn btn-default">开始</button><button class="btn btn-default delBtn">删除</button></div><p class="state">等待上传...</p></div>'),$(i.uploaderBox).find(".ctlAllBtn").html()||(1==i.fileNumLimit?$(i.uploaderBox).find(".btns").hide():$(i.uploaderBox).find(".btns").append('<button class="btn btn-default ctlAllBtn">全部上传</button><button class="btn btn-default delAllBtn">全部删除</button>'))}),e[i.uploaderObj].on("uploadBeforeSend",function(e,t,o){i.fileBeforeSend&&i.fileBeforeSend(e,t,o)}),e[i.uploaderObj].on("uploadProgress",function(e,t){var o=$("#"+e.id),i=o.find(".progress .progress-bar");o.find("p.state").text("上传中..."),i.css("width",100*t+"%")}),e[i.uploaderObj].on("uploadAccept",function(e,t){if(1!=o){if(!t.Data.length)return!1;if("ok"!=t.Data[0].UploadTips)return!1}}),e[i.uploaderObj].on("uploadSuccess",function(e,t){$("#"+e.id).find(".startBtn").remove(),$("#"+e.id).find("p.state").html('<span type="color:#81c868">上传成功</span>'),1!=o&&($("#"+e.id).attr("data",t.Data[0].ResourceId),$("#"+e.id).append('<input type="hidden" value="'+t.Data[0].ResourceId+'">')),i.succ&&i.succ(t)}),e[i.uploaderObj].on("uploadError",function(e){setTimeout(function(){$("#"+e.id).find(".progress-bar").animate({width:"0%"},400)},400),$("#"+e.id).find(".startBtn").html("重新上传"),$("#"+e.id).find("p.state").html('<span style="color: #f43838">上传出错</span>'),i.error&&i.error(e)}),e[i.uploaderObj].on("uploadComplete",function(e){}),e[i.uploaderObj].on("error",function(e){"F_DUPLICATE"==e?window.parent.vdialog({title:"系统提示",type:"error",modal:!0,content:"您已经上传了一份，请不要重复上传！",ok:!0}):"F_EXCEED_SIZE"==e?window.parent.vdialog({title:"系统提示",type:"error",modal:!0,content:"单个附件的大小不可超过 16M 哦！换个小点的文件吧！",ok:!0}):"Q_TYPE_DENIED"==e&&window.parent.vdialog({title:"系统提示",type:"error",modal:!0,content:"为了系统安全，请上传系统规定的文件<br />doc，docx，pdf，zip，rar，xls，xlsx",ok:!0})}),$(i.uploaderBox).on("click",".ctlAllBtn",function(){$(i.uploaderBox).find(i.uploaderList+" .item").each(function(){e[i.uploaderObj].upload($(this).attr("id"))})}),$(i.uploaderBox).on("click",".delAllBtn",function(){$(i.uploaderBox).find(i.uploaderList+" .item").each(function(){i.del&&i.del($(this).attr("data")),e[i.uploaderObj].removeFile($(this).attr("id")),$(this).remove()}),$(i.uploaderBox).find(".ctlAllBtn , .delAllBtn").remove()}),$(i.uploaderBox).on("click",".delBtn",function(){$(i.uploaderBox).find(".btns").show(),1==$(i.uploaderBox).find(i.uploaderList+" .item").length&&$(i.uploaderBox).find(".ctlAllBtn , .delAllBtn").remove(),e[i.uploaderObj].removeFile($(this).parents(".item").attr("id")),$(this).parents(".item").remove(),i.del&&i.del($(this).parents(".item").attr("data"))}),$(i.uploaderBox).on("click",".startBtn",function(){e[i.uploaderObj].upload($(this).parents(".item").attr("id"))})}function eosUploaderImg(a){var d={},l=($(a.uploaderBox).find(".eos_uploader_img"),$(a.uploaderBox).find(".filelist")),r=0;function i(e,t){$(a.uploaderBox).find(".placeholder").hide();var o=$('<li id="'+e+'" class="item" data-num="dataImg" data="'+e+'"><p class="title"> </p><p class="imgWrap"></p><p class="progress"><span></span></p></li>'),i=($('<div class="file-panel"><span class="cancel">删除</span>').appendTo(o),o.find("p.progress span"),o.find("p.imgWrap")),n=($('<p class="error"></p>'),$('<img src="'+t+'">'));i.empty().append(n),o.prependTo(l),++r<a.fileNumLimit?($(a.uploaderBox).find(".statusBar").show(),$(a.continueBtn).show(),d[a.uploaderObj].addButton({id:a.continueBtn,label:"继续添加"})):$(a.continueBtn).hide()}d[a.uploaderObj]=WebUploader.create({auto:!1,swf:!1,server:a.serverUrl,pick:a.initBtn,fileNumLimit:a.fileNumLimit,fileSingleSizeLimit:a.fileSingleSizeLimit,formData:a.data,accept:{title:"Images",extensions:"gif,jpg,jpeg,bmp,png",mimeTypes:""}}),function(){var e=a.ResourceIds,t=a.imgUrls;if(null!=e&&""!=e)if("[object Array]"===Object.prototype.toString.call(e))for(var o=0;o<e.length;o++)i(e[o],t[o]);else i(e,t)}(),d[a.uploaderObj].on("dndAccept",function(e){for(var t=!1,o=e.length,i=0;i<o;i++)if(~"text/plain;application/javascript ".indexOf(e[i].type)){t=!0;break}return!t}),d[a.uploaderObj].on("uploadBeforeSend",function(e,t,o){a.fileBeforeSend&&a.fileBeforeSend(e,t,o)}),d[a.uploaderObj].on("fileQueued",function(e){!function(e){$(a.uploaderBox).find(".placeholder").hide();var t=$('<li id="'+e.id+'" class="item"><p class="title">'+e.name+'</p><p class="imgWrap"></p><p class="progress"><span></span></p></li>'),i=($('<div class="file-panel"><span class="cancel">删除</span>').appendTo(t),t.find("p.progress span"),t.find("p.imgWrap"));$('<p class="error"></p>'),d[a.uploaderObj].makeThumb(e,function(e,t){var o;e?i.text("不能预览"):(o=$('<img src="'+t+'">'),i.empty().append(o))},110,110),t.prependTo(l)}(e),$(a.uploaderBox).find(".info").html(t),r++,e.size;var t="选中 "+r+" 张图片";1===r&&($(a.uploaderBox).find(".statusBar").show(),$(a.continueBtn).show(),d[a.uploaderObj].addButton({id:a.continueBtn,label:"继续添加"})),r>=a.fileNumLimit&&$(a.continueBtn).hide()}),d[a.uploaderObj].on("uploadProgress",function(e,t){$("#"+e.id).find(".progress span").css("width",100*t+"%")}),d[a.uploaderObj].on("uploadAccept",function(e,t){return!!t.Data.length&&("ok"==t.Data[0].UploadTips&&void 0)}),d[a.uploaderObj].on("uploadSuccess",function(e,t){$("#"+e.id).addClass("upload-state-done");var o=$("#"+e.id),i=o.find("div.success");i.length||(i=$('<div class="success"></div>').appendTo(o)),i.text(""),$("#"+e.id).append('<input type="hidden" value="'+t.Data[0].ResourceId+'">'),$("#"+e.id).attr("data",t.Data[0].ResourceId),a.succ&&a.succ(t)}),d[a.uploaderObj].on("fileDequeued",function(e){r--,e.size,r||($(a.uploaderBox).find(".statusBar").hide(),$(a.uploaderBox).find(".placeholder").show())}),d[a.uploaderObj].on("uploadError",function(e){setTimeout(function(){$("#"+e.id).find(".progress span").animate({width:"0%"},200)},200);var t=$("#"+e.id),o=t.find("div.error");o.length||(o=$('<div class="error"></div>').appendTo(t)),o.text("上传失败"),a.error&&a.error(e)}),d[a.uploaderObj].on("uploadComplete",function(e){var t=d[a.uploaderObj].getStats(),o="共 "+r+" 张，已上传 "+t.successNum+" 张";t.uploadFailNum&&(o+="，失败 "+t.uploadFailNum+' 张；<a class="retry" href="Javascript:;">重新上传 </a>失败图片'),$(a.uploaderBox).find(".info").html(o)}),$(a.uploaderBox).on("click",".uploadBtn",function(){d[a.uploaderObj].upload()}),$(a.uploaderBox).on("click",".cancel",function(){"dataImg"==$(this).parents(".item").attr("data-num")?(r-=1,$(this).parents(".item").remove(),a.del&&a.del($(this).parents(".item").attr("id")),r?r<a.fileNumLimit&&$(a.continueBtn).show():($(a.uploaderBox).find(".statusBar").hide(),$(a.uploaderBox).find(".placeholder").show(),d[a.uploaderObj].addButton({id:a.initBtn,label:"点击选择图片"}))):(d[a.uploaderObj].removeFile($(this).parents(".item").attr("id")),$(this).parents(".item").remove(),null!=$(this).parents(".item").find("input:hidden").val()&&a.del&&a.del($(this).parents(".item").find("input:hidden").val()),r<a.fileNumLimit&&$(a.continueBtn).show())}),d[a.uploaderObj].on("error",function(e){"F_DUPLICATE"==e?window.parent.vdialog({title:"系统提示",type:"error",modal:!0,content:"您已经上传了一份，请不要重复上传！",ok:!0}):"F_EXCEED_SIZE"==e?window.parent.vdialog({title:"系统提示",type:"error",modal:!0,content:"单个附件的大小不可超过 3M 哦！换个小点的文件吧！",ok:!0}):"Q_EXCEED_NUM_LIMIT"==e?window.parent.vdialog({title:"系统提示",type:"error",modal:!0,content:"您准备上传的照片超过限定的数量啦！",ok:!0}):"Q_TYPE_DENIED"==e&&window.parent.vdialog({title:"系统提示",type:"error",modal:!0,content:"请上传系统规定的文件<br />gif，jpg，jpeg，bmp，png",ok:!0})}),$(a.uploaderBox).on("mouseenter",".queueList li.item",function(){console.log("11111"),$(this).find(".file-panel").stop().animate({height:29})}),$(a.uploaderBox).on("mouseleave",".queueList li.item",function(){$(this).find(".file-panel").stop().animate({height:0})}),$(a.uploaderBox).on("click",".retry",function(){d[a.uploaderObj].retry()})}